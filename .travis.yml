language: node_js
node_js:
  - "10.8.0"

branches:
  only:
  - master

cache:
  directories:
    - node_modules

notifications:
  email: false

env:
  global:
    # MONGODB_DATABASE
    - secure: "ya6I4B9HKDqR8m8phxIAAqj759wLjISFu2dy1RZ8r1TNGTb4sW7Kltx5a9ytT+40WMFg5PkEM9hZG6XLSQgtNmdo5oiEOrXp61/3J2b9maOh5xpDq/KL5ELPZDNEqnEtW3NenrF9o7igqCEaI2GU4jZBCWHAaJLKZjH1+iLTrPWZfjnzA7u2GesptDdkqQSjll3SoEvBuV7Ie0Arn9RyAIq+OyTJJ4HDoqa/AN0J1D0g5gTmbzuSQf/vJMi3oMYYOw67pKAa3E2sY44kNZd3hB99aeiWU8l0yz8OU5C96slE4B5MN6kkAbGGVViDOw+xi9oRcqf+Nr8VRSOOy1eewDpOzKjyvXcoe3RrzqcZZZn3LqUzPy9J7TWRA33e26Yg3wQRwLni5qO3KH41k97Taxqv0VwekQ13jO0c4s5OrO2zi8aSUaddluuF/I5JnBnSj/hqK/97Bym7r8to4aC+NW0YHYTfsGHqT/p6DUAFlMb0TkgReNoJGdCh04aBuKX8DiTjJv22r2N8O4VJ2LQeJxxowM4Bfvr6pdn1bDJJG/ZWOKq7OBxpkwpcO6jskYfmVagLf4+gmq75sQLD+lK8cvPmTxlVfhJKTKdVHeUK8w9LfxoB1BFT7IdBaqSUmeAGHzDx2EaZAz9pPU5dUpq0uWg2NgnR6mmVw8F2AR8nbC4="

before_install:
- curl -o- -L https://yarnpkg.com/install.sh | bash -s -- --version 1.9.4
- export PATH="$HOME/.yarn/bin:$HOME/.config/yarn/global/node_modules/.bin:$PATH"
- printf 'yarn-offline-mirror "./.yarn-offline-mirror"\n--production false\n--pure-lockfile true' >> .yarnrc

install:
- yarn install

script:
- echo $MONGODB_DATABASE
- yarn run test

deploy:
  provider: heroku
  api_key:
    secure: Yzc3ndN0QDeBLwLIofMIrSNqmHq0kssjDd+P6SPK01jnx19H8qq0jnpLXfQgtasfpTb+ys36kQ33NCc7Fv0hAn5CDdPTDt7h1x8bie9pHzm5oyW3MtsVtqo7BWTjkuJiUxY0ouS2g0e3F2zYFw0eb9EBMzlDfqLT/7uVqstm4QIoBPlvvMrtKRrTbheT4ya5q5qrWaC+kpepoAAOrDMyUdDGciId75j0u3Fe4xjlBvqMP/wJASGXoi5T9zvmOoqGRjvaUi/Ch8BvGX7Tl+ZYtJbP/eUEYlJf1dp5Fp/hDjBfLMT7blPqp3KDdcSdWuapqTT3OmryfuQD8d5MWi6TxJBznxizC74vlTpL665j06AC3lJyeuIGxkjw9MZ0cwI/O8ib42l0hj7LRuVGhfEq+U7Q8ADG4RI51pGRzS6s1CKvRUZNlw1cELGolVuOMXwuzK1aAozB/ORoNTAflMXV3Vra/NKJlgfsL0LGG5aNd5TJKciahpSMvq6Hh+aeFlvyVEqHYq1XpeNZ/H5o9io3pu9xzypG1CR7StOVsZRhk8xA/pw4a9Ms73MCRvf/3j6zQZheTF/44Ii8K/A35Bre4TcDsx8dZRVa5alR6Spp7U4duTDm69n3BkoehDKm9DjnqaJ5Q1sQAT3cFke1Dkt1h1WMW9j77qQkRQwtjcRX2XY=
  skip-cleanup: true
  on:
    branch: master
  app: ps-family-tree-bff
